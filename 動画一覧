function myFunction() {

  // 調べたいチャンネルID
  const channelId = 'UCLt_iMYoJv1gYzwGdjdXYJg'; 

  // 取得する動画の最大値
  // 実行時間が360secを超える場合は実行失敗になるので自分の環境に合わせて変更してください
  const limit = 1000;

  // 出力するスプレッドシート取得
  const sh = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');
  sh.clear();

  // チャンネル取得
  const channelPart = 'contentDetails, snippet, status';
  const channel = YouTube.Channels.list(channelPart, {'id': channelId});
  
  // 取得するプレイリストのパラメータ
  const playListId = channel.items[0].contentDetails.relatedPlaylists.uploads;
  const playListPart = 'snippet';
  let nextPageToken = '';

  // 取得する動画のパラメータ
  const videoPart = 'snippet, statistics, contentDetails, status';

  // スプレッドシート出力用配列
  let array = [];
  array.push(['id', 'サムネurl', 'title', '公開設定', '日付', '再生数', 'コメント', 'いいね', '時間']);

  do{
    // 
    let playListItems = YouTube.PlaylistItems.list(playListPart, {'playlistId': playListId, 'maxResults': 50, 'pageToken': nextPageToken});

    for(const play of playListItems.items){

      // 動画情報取得
      let videoId = play.snippet.resourceId.videoId;
      let video = YouTube.Videos.list(videoPart, {'id': videoId});
      let videoItem = video.items[0];

      // 出力用変数
      let thumbnailUrl = videoItem.snippet.thumbnails.standard.url;
      let videoTitle = play.snippet.title;
      let videoPrivacy = videoItem.status.privacyStatus;
      let videoDate = videoItem.snippet.publishedAt;
      let videoCount = videoItem.statistics.viewCount;
      let videoComment = videoItem.statistics.commentCount;
      let videoLike = videoItem.statistics.likeCount;
      let videoTime = videoItem.contentDetails.duration;

      Logger.log('No ' + array.length + ':' + videoTitle);

      // 配列に追加
      array.push([videoId, thumbnailUrl, videoTitle, videoPrivacy, videoDate, videoCount, videoComment, videoLike, videoTime]);
    }
    // 
    nextPageToken = playListItems.nextPageToken || '';

  }while(nextPageToken && limit > array.length);
  
  // スプレッドシートに出力する
  sh.getRange(1, 1, array.length, array[0].length).setValues(array);

}
